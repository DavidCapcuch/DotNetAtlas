// <auto-generated />

#nullable disable

using Microsoft.EntityFrameworkCore;
using Microsoft.EntityFrameworkCore.Infrastructure;
using Microsoft.EntityFrameworkCore.Migrations;

namespace DotNetAtlas.Infrastructure.Persistence.Database.Migrations
{
    [DbContext(typeof(WeatherDbContext))]
    [Migration("20251108150555_CreateOutboxMessagesTable")]
    partial class CreateOutboxMessagesTable
    {
        /// <inheritdoc />
        protected override void BuildTargetModel(ModelBuilder modelBuilder)
        {
#pragma warning disable 612, 618
            modelBuilder
                .HasDefaultSchema("weather")
                .HasAnnotation("ProductVersion", "10.0.0-rc.1.25451.107")
                .HasAnnotation("Relational:MaxIdentifierLength", 128);

            SqlServerModelBuilderExtensions.UseIdentityColumns(modelBuilder);

            modelBuilder.Entity("DotNetAtlas.Domain.Entities.Weather.Feedback.Feedback", b =>
                {
                    b.Property<Guid>("Id")
                        .HasColumnType("uniqueidentifier")
                        .HasComment("PK");

                    b.Property<Guid>("CreatedByUser")
                        .HasColumnType("uniqueidentifier")
                        .HasComment("User who created the feedback.");

                    b.Property<DateTimeOffset>("CreatedUtc")
                        .HasColumnType("datetimeoffset")
                        .HasComment("Creation timestamp (UTC).");

                    b.Property<DateTimeOffset>("LastModifiedUtc")
                        .HasColumnType("datetimeoffset")
                        .HasComment("Last modification timestamp (UTC).");

                    b.Property<byte[]>("Timestamp")
                        .IsConcurrencyToken()
                        .ValueGeneratedOnAddOrUpdate()
                        .HasColumnType("rowversion")
                        .HasComment("Optimistic concurrency token.");

                    b.ComplexProperty(typeof(Dictionary<string, object>), "FeedbackText", "DotNetAtlas.Domain.Entities.Weather.Feedback.Feedback.FeedbackText#FeedbackText", b1 =>
                        {
                            b1.IsRequired();

                            b1.Property<string>("Value")
                                .IsRequired()
                                .HasMaxLength(500)
                                .HasColumnType("nvarchar(500)")
                                .HasColumnName("Feedback")
                                .HasComment("Weather feedback from the user.");
                        });

                    b.ComplexProperty(typeof(Dictionary<string, object>), "Rating", "DotNetAtlas.Domain.Entities.Weather.Feedback.Feedback.Rating#FeedbackRating", b1 =>
                        {
                            b1.IsRequired();

                            b1.Property<int>("Value")
                                .HasColumnType("int")
                                .HasColumnName("Rating")
                                .HasComment("Rating given by the user.");
                        });

                    b.HasKey("Id");

                    b.HasIndex("CreatedByUser")
                        .IsUnique()
                        .HasDatabaseName("UX_WeatherFeedback_CreatedByUser");

                    b.ToTable("Feedbacks", "weather", t =>
                        {
                            t.HasComment("Contains user feedbacks about the weather.");
                        });
                });

            modelBuilder.Entity("DotNetAtlas.Outbox.Core.OutboxMessage", b =>
                {
                    b.Property<long>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("bigint")
                        .HasComment("PK, Identity");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<long>("Id"));

                    b.Property<byte[]>("AvroPayload")
                        .IsRequired()
                        .HasColumnType("varbinary(max)")
                        .HasComment("Avro-serialized domain event payload");

                    b.Property<DateTimeOffset>("CreatedUtc")
                        .HasColumnType("datetimeoffset")
                        .HasComment("Creation timestamp (UTC).");

                    b.Property<string>("Headers")
                        .HasMaxLength(8192)
                        .IsUnicode(false)
                        .HasColumnType("varchar(max)")
                        .HasComment("JSON dictionary of OpenTelemetry-standard headers for distributed tracing and metadata. Headers are automatically generated by OpenTelemetry propagators for end-to-end trace context propagation.");

                    b.Property<string>("KafkaKey")
                        .HasMaxLength(36)
                        .HasColumnType("nvarchar(36)")
                        .HasComment("Kafka Key - typically the Aggregate ID for proper event ordering and partitioning");

                    b.Property<string>("Type")
                        .IsRequired()
                        .HasMaxLength(255)
                        .IsUnicode(false)
                        .HasColumnType("varchar(255)")
                        .HasComment("Avro type name of the serialized event (e.g., 'FeedbackChangedEvent') used for type-based topic routing");

                    b.HasKey("Id");

                    b.ToTable("OutboxMessages", "weather", t =>
                        {
                            t.HasComment("Outbox pattern table for storing domain events as Avro-serialized messages for reliable event publishing.");
                        });
                });
#pragma warning restore 612, 618
        }
    }
}
